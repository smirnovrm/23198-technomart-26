var loginBlock=document.querySelector(".login-block ul"),profileBlock=document.querySelector(".profile-bar"),addLinkBlock=document.querySelector(".additional"),bookmarkBtn=document.querySelector(".extra a[title='Закладки']"),basketBtn=document.querySelector(".extra a[title='Корзина']"),bookmarBtnCnt=document.querySelector("a[title='Закладки'] span"),basketBtnCnt=document.querySelector("a[title='Корзина'] span"),loginBtn=document.querySelector(".login-btn"),logoutBtn=document.querySelector(".logout-btn"),mapModal=document.querySelector("#map-modal"),contactModal=document.querySelector("#contact-modal"),basketModal=document.querySelector("#basket-modal"),openMap=document.querySelector("#map"),openContact=document.querySelector("#open-contact"),closeMapBtn=document.querySelector("#map-modal .popup-close"),closeContactBtn=document.querySelector("#contact-modal .popup-close"),closeBasketBtn=document.querySelector("#basket-modal .modal-wrap .popup-close"),continueShopingBtn=document.querySelector("#continue-btn"),favoriteCnt=0,basketCnt=0;try{openMap.addEventListener("click",function(e){e.preventDefault(),mapModal.classList.add("show")}),closeMapBtn.addEventListener("click",function(e){e.preventDefault(),mapModal.classList.remove("show")})}catch(e){console.log("На странице отсутствует модальное окно")}try{openContact.addEventListener("click",function(e){e.preventDefault(),contactModal.classList.add("show"),personName.focus()}),closeContactBtn.addEventListener("click",function(e){e.preventDefault(),contactModal.classList.remove("show")})}catch(e){console.log("На странице отсутствует модальное окно")}loginBtn.addEventListener("click",function(e){e.preventDefault(),loginBlock.classList.add("visually-hidden"),profileBlock.classList.remove("visually-hidden"),addLinkBlock.classList.remove("visually-hidden")}),logoutBtn.addEventListener("click",function(e){e.preventDefault(),loginBlock.classList.remove("visually-hidden"),profileBlock.classList.add("visually-hidden"),addLinkBlock.classList.add("visually-hidden")}),document.querySelector(".catalog-items").addEventListener("click",function(e){"bookmark"===e.target.className?(favoriteCnt++,bookmarBtnCnt.innerHTML=favoriteCnt,bookmarkBtn.classList.add("added-item")):"buy"===e.target.className&&(basketModal.classList.add("show"),basketCnt++,0!==basketBtnCnt.innerHTML&&basketBtnCnt.innerHTML++,basketBtn.classList.add("added-item"))});try{closeBasketBtn.addEventListener("click",function(e){basketModal.classList.remove("show")}),continueShopingBtn.addEventListener("click",function(e){basketModal.classList.remove("show")})}catch(e){console.log("Не могу закрыть окно")}try{var form=contactModal.querySelector("form"),personName=contactModal.querySelector("#name-person"),email=contactModal.querySelector("#email-person"),msg=contactModal.querySelector("#mail-text");localStorage.getItem("personName")&&""!==localStorage.getItem("personName")&&(personName.value=localStorage.getItem("personName")),localStorage.getItem("email")&&""!==localStorage.getItem("email")&&(email.value=localStorage.getItem("email")),!localStorage.getItem("msg")||""===localStorage.getItem("msg")&&"В свободной форме"!==localStorage.getItem("msg")||(msg.value=localStorage.getItem("msg")),form.addEventListener("submit",function(e){if(personName.value){personName.classList.remove("error");try{localStorage.setItem("personName",personName.value)}catch(e){console.log("Ошибка записи в локальное хранилище")}}else e.preventDefault(),personName.classList.add("error"),personName.placeholder="Введите ваше имя";if(email.value){email.classList.remove("error");try{localStorage.setItem("email",email.value)}catch(e){console.log("Ошибка записи в локальное хранилище")}}else e.preventDefault(),email.classList.add("error"),email.placeholder="Введите вашу почту";if(msg.value&&"В свободной форме"!==msg.value){msg.classList.remove("error");try{localStorage.setItem("msg",msg.value)}catch(e){console.log("Ошибка записи в локальное хранилище")}}else e.preventDefault(),msg.value="",msg.classList.add("error")})}catch(e){console.log("На странице отсутствует форма")}window.addEventListener("keydown",function(e){if(27===e.keyCode){try{mapModal.classList.contains("show")&&mapModal.classList.remove("show")}catch(e){console.log("Нет модального окна")}try{contactModal.classList.contains("show")&&contactModal.classList.remove("show")}catch(e){console.log("Нет модального окна")}try{basketModal.classList.contains("show")&&basketModal.classList.remove("show")}catch(e){console.log("Нет модального окна")}}});
